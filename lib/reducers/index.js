Object.defineProperty(exports,"__esModule",{value:true});exports.reducer=exports.apiMiddleware=undefined;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};var _reactNative=require('react-native');var API='https://rocali-alert-api.herokuapp.com/';token='';var apiMiddleware=exports.apiMiddleware=function apiMiddleware(store){return function(next){return function(action){next(action);switch(action.type){case'LOGIN':store.dispatch({type:'LOGIN_LOADING'});if(action.email!=null&&action.password!=null){email=action.email;password=action.password;}else{email='rocali@outlook.com';password='password';}fetch(API+'/auth/login',{method:'POST',headers:{'Accept':'application/json','Content-Type':'application/json'},body:JSON.stringify({email:email,password:password})}).then(function(response){return response.json();}).then(function(data){return next({type:'LOGIN_RESPONSE',data:data});}).catch(function(error){return next({type:'LOGIN_ERROR',error:error});});break;case'GET_APPOINTMENTS':console.log('FOO');store.dispatch({type:'GET_APPOINTMENT_LOADING'});console.log('GET_APPOINTMENT - TOKEN');console.log(token);console.log('We have TOKEN!!');console.log(token);fetch(API+'/appointments',{method:'GET',headers:{'Accept':'application/vnd.todos.v1+json','Authorization':token}}).then(function(response){return response.json();}).then(function(data){return next({type:'GET_APPOINTMENT_RECEIVED',data:data});}).catch(function(error){return next({type:'GET_APPOINTMENT_ERROR',error:error});});break;case'GET_ELEMENTS':store.dispatch({type:'GET_ELEMENT_LOADING'});fetch(API+'/elements',{method:'GET',headers:{'Accept':'application/vnd.todos.v1+json','Authorization':token}}).then(function(response){return response.json();}).then(function(data){return next({type:'GET_ELEMENT_RECEIVED',data:data});}).catch(function(error){return next({type:'GET_ELEMENT_ERROR',error:error});});break;default:break;}};};};var reducer=exports.reducer=function reducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{currentScreen:'login',logged:false,appointments:[],elements:[],loading:true};var action=arguments[1];console.log('reducer');console.log(action.type);switch(action.type){case'LOGIN_LOADING':return{currentScreen:'login',loading:true};case'LOGIN_RESPONSE':token=action.data.auth_token;message=action.data.message;logged=token!=null?true:false;return _extends({},state,{currentScreen:'login',logged:logged,loading:false,message:message});case'LOGIN_ERROR':return _extends({},state,{currentScreen:'login',loading:false});case'GET_APPOINTMENT_LOADING':return _extends({},state,{currentScreen:'appointments',loading:true});case'GET_APPOINTMENT_RECEIVED':return _extends({},state,{currentScreen:'appointments',loading:false,appointments:action.data});case'GET_APPOINTMENT_ERROR':console.log(state);return state;case'GET_ELEMENT_LOADING':return _extends({},state,{currentScreen:'elements',loading:true});case'GET_ELEMENT_RECEIVED':return _extends({},state,{currentScreen:'elements',loading:false,elements:action.data});case'GET_ELEMENT_ERROR':console.log(state);return state;default:return state;}};